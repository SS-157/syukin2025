<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>出勤簿 - 勤怠管理システム</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap');
        body {
            font-family: 'Noto Sans JP', sans-serif;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card-shadow {
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .status-present {
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
        }
        .status-absent {
            background: linear-gradient(135deg, #f87171 0%, #ef4444 100%);
        }
        .status-late {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
        }
        .hover-scale {
            transition: transform 0.2s ease;
        }
        .hover-scale:hover {
            transform: scale(1.02);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="gradient-bg text-white py-6 px-4">
        <div class="max-w-6xl mx-auto">
            <h1 class="text-3xl font-bold text-center mb-2">📋 出勤簿</h1>
            <p class="text-center text-blue-100">勤怠管理システム</p>
        </div>
    </header>

    <div class="max-w-6xl mx-auto p-6">
        <!-- Date and Summary Section -->
        <div class="grid md:grid-cols-3 gap-6 mb-8">
            <div class="bg-white rounded-xl p-6 card-shadow">
                <h3 class="text-lg font-semibold text-gray-800 mb-2">📅 今日の日付</h3>
                <p class="text-2xl font-bold text-blue-600" id="currentDate"></p>
            </div>
            <div class="bg-white rounded-xl p-6 card-shadow">
                <h3 class="text-lg font-semibold text-gray-800 mb-2">👥 出勤者数</h3>
                <p class="text-2xl font-bold text-green-600" id="presentCount">0</p>
            </div>
            <div class="bg-white rounded-xl p-6 card-shadow">
                <h3 class="text-lg font-semibold text-gray-800 mb-2">📊 出勤率</h3>
                <p class="text-2xl font-bold text-purple-600" id="attendanceRate">0%</p>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="bg-white rounded-xl p-6 card-shadow mb-8">
            <h3 class="text-xl font-semibold text-gray-800 mb-4">⚡ クイックアクション</h3>
            <div class="flex flex-wrap gap-4">
                <button onclick="addEmployee()" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium hover-scale">
                    ➕ 従業員追加
                </button>
                <button onclick="markAllPresent()" class="bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-medium hover-scale">
                    ✅ 全員出勤
                </button>
                <button onclick="exportData()" class="bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg font-medium hover-scale">
                    📤 データ出力
                </button>
            </div>
        </div>

        <!-- Employee List -->
        <div class="bg-white rounded-xl p-6 card-shadow">
            <h3 class="text-xl font-semibold text-gray-800 mb-6">👨‍💼 従業員出勤状況</h3>
            <div class="overflow-x-auto">
                <table class="w-full">
                    <thead>
                        <tr class="border-b-2 border-gray-200">
                            <th class="text-left py-3 px-4 font-semibold text-gray-700">従業員名</th>
                            <th class="text-left py-3 px-4 font-semibold text-gray-700">部署</th>
                            <th class="text-left py-3 px-4 font-semibold text-gray-700">出勤時刻</th>
                            <th class="text-left py-3 px-4 font-semibold text-gray-700">退勤時刻</th>
                            <th class="text-left py-3 px-4 font-semibold text-gray-700">状態</th>
                            <th class="text-left py-3 px-4 font-semibold text-gray-700">アクション</th>
                        </tr>
                    </thead>
                    <tbody id="employeeList">
                        <!-- Employee rows will be inserted here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Add Employee Modal -->
    <div id="addEmployeeModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <h3 class="text-xl font-semibold text-gray-800 mb-6">新しい従業員を追加</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">従業員名</label>
                    <input type="text" id="employeeName" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="山田太郎">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">部署</label>
                    <select id="employeeDepartment" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="営業部">営業部</option>
                        <option value="開発部">開発部</option>
                        <option value="人事部">人事部</option>
                        <option value="経理部">経理部</option>
                        <option value="総務部">総務部</option>
                    </select>
                </div>
            </div>
            <div class="flex gap-4 mt-6">
                <button onclick="saveEmployee()" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg font-medium">
                    保存
                </button>
                <button onclick="closeModal()" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-2 px-4 rounded-lg font-medium">
                    キャンセル
                </button>
            </div>
        </div>
    </div>

    <script>
        let employees = [
            { id: 1, name: '田中花子', department: '営業部', status: 'present', checkIn: '09:00', checkOut: '' },
            { id: 2, name: '佐藤次郎', department: '開発部', status: 'present', checkIn: '08:45', checkOut: '' },
            { id: 3, name: '鈴木三郎', department: '人事部', status: 'late', checkIn: '09:30', checkOut: '' },
            { id: 4, name: '高橋四郎', department: '経理部', status: 'absent', checkIn: '', checkOut: '' },
            { id: 5, name: '伊藤五郎', department: '総務部', status: 'present', checkIn: '08:50', checkOut: '' }
        ];

        function updateCurrentDate() {
            const now = new Date();
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric', 
                weekday: 'long' 
            };
            document.getElementById('currentDate').textContent = now.toLocaleDateString('ja-JP', options);
        }

        function updateSummary() {
            const presentCount = employees.filter(emp => emp.status === 'present' || emp.status === 'late').length;
            const totalCount = employees.length;
            const attendanceRate = totalCount > 0 ? Math.round((presentCount / totalCount) * 100) : 0;

            document.getElementById('presentCount').textContent = presentCount;
            document.getElementById('attendanceRate').textContent = attendanceRate + '%';
        }

        function getStatusBadge(status) {
            const badges = {
                'present': '<span class="status-present text-white px-3 py-1 rounded-full text-sm font-medium">✅ 出勤</span>',
                'absent': '<span class="status-absent text-white px-3 py-1 rounded-full text-sm font-medium">❌ 欠勤</span>',
                'late': '<span class="status-late text-white px-3 py-1 rounded-full text-sm font-medium">⏰ 遅刻</span>'
            };
            return badges[status] || badges['absent'];
        }

        function renderEmployees() {
            const tbody = document.getElementById('employeeList');
            tbody.innerHTML = employees.map(emp => `
                <tr class="border-b border-gray-100 hover:bg-gray-50">
                    <td class="py-4 px-4 font-medium text-gray-900">${emp.name}</td>
                    <td class="py-4 px-4 text-gray-600">${emp.department}</td>
                    <td class="py-4 px-4 text-gray-600">${emp.checkIn || '-'}</td>
                    <td class="py-4 px-4 text-gray-600">${emp.checkOut || '-'}</td>
                    <td class="py-4 px-4">${getStatusBadge(emp.status)}</td>
                    <td class="py-4 px-4">
                        <div class="flex gap-2">
                            <button onclick="toggleStatus(${emp.id})" class="bg-blue-100 hover:bg-blue-200 text-blue-700 px-3 py-1 rounded text-sm font-medium">
                                状態変更
                            </button>
                            <button onclick="checkOut(${emp.id})" class="bg-green-100 hover:bg-green-200 text-green-700 px-3 py-1 rounded text-sm font-medium">
                                退勤
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
            updateSummary();
        }

        function toggleStatus(id) {
            const employee = employees.find(emp => emp.id === id);
            if (employee) {
                const statuses = ['present', 'absent', 'late'];
                const currentIndex = statuses.indexOf(employee.status);
                employee.status = statuses[(currentIndex + 1) % statuses.length];
                
                if (employee.status === 'present' && !employee.checkIn) {
                    employee.checkIn = new Date().toLocaleTimeString('ja-JP', { hour: '2-digit', minute: '2-digit' });
                } else if (employee.status === 'absent') {
                    employee.checkIn = '';
                    employee.checkOut = '';
                }
                
                renderEmployees();
            }
        }

        function checkOut(id) {
            const employee = employees.find(emp => emp.id === id);
            if (employee && (employee.status === 'present' || employee.status === 'late')) {
                employee.checkOut = new Date().toLocaleTimeString('ja-JP', { hour: '2-digit', minute: '2-digit' });
                renderEmployees();
            }
        }

        function addEmployee() {
            document.getElementById('addEmployeeModal').classList.remove('hidden');
            document.getElementById('addEmployeeModal').classList.add('flex');
        }

        function closeModal() {
            document.getElementById('addEmployeeModal').classList.add('hidden');
            document.getElementById('addEmployeeModal').classList.remove('flex');
            document.getElementById('employeeName').value = '';
            document.getElementById('employeeDepartment').value = '営業部';
        }

        function saveEmployee() {
            const name = document.getElementById('employeeName').value.trim();
            const department = document.getElementById('employeeDepartment').value;
            
            if (name) {
                const newEmployee = {
                    id: Math.max(...employees.map(emp => emp.id)) + 1,
                    name: name,
                    department: department,
                    status: 'absent',
                    checkIn: '',
                    checkOut: ''
                };
                employees.push(newEmployee);
                renderEmployees();
                closeModal();
            }
        }

        function markAllPresent() {
            employees.forEach(emp => {
                if (emp.status === 'absent') {
                    emp.status = 'present';
                    emp.checkIn = new Date().toLocaleTimeString('ja-JP', { hour: '2-digit', minute: '2-digit' });
                }
            });
            renderEmployees();
        }

        function exportData() {
            const data = employees.map(emp => ({
                名前: emp.name,
                部署: emp.department,
                状態: emp.status === 'present' ? '出勤' : emp.status === 'late' ? '遅刻' : '欠勤',
                出勤時刻: emp.checkIn || '-',
                退勤時刻: emp.checkOut || '-'
            }));
            
            const csvContent = "data:text/csv;charset=utf-8," 
                + Object.keys(data[0]).join(',') + '\n'
                + data.map(row => Object.values(row).join(',')).join('\n');
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", `出勤簿_${new Date().toISOString().split('T')[0]}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Initialize the app
        updateCurrentDate();
        renderEmployees();
        
        // Update time every minute
        setInterval(updateCurrentDate, 60000);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97a33b95a1cbd48e',t:'MTc1NzA0OTE1OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
